function ponchoTable(a){var l,t,c=[],d=[],r=[],h=[],o="",p=[],u="";function s(e){jQuery.getJSON(e,function(e){function t(e){return e.replace(/έ/g,"ε").replace(/[ύϋΰ]/g,"υ").replace(/ό/g,"ο").replace(/ώ/g,"ω").replace(/ά/g,"α").replace(/[ίϊΐ]/g,"ι").replace(/ή/g,"η").replace(/\n/g," ").replace(/[áÁ]/g,"a").replace(/[éÉ]/g,"e").replace(/[íÍ]/g,"i").replace(/[óÓ]/g,"o").replace(/[úÚ]/g,"u").replace(/ê/g,"e").replace(/î/g,"i").replace(/ô/g,"o").replace(/è/g,"e").replace(/ï/g,"i").replace(/ü/g,"u").replace(/ã/g,"a").replace(/õ/g,"o").replace(/ç/g,"c").replace(/ì/g,"i")}c=e.values,jQuery.each(Object.keys(c[0]),function(e,t){c[0][t]&&(d.push(c[0][t]),r.push(t),o+="<th>"+c[1][t]+"</th>",p.push(c[1][t]))}),jQuery("#ponchoTable caption").html(a.tituloTabla),jQuery("#ponchoTable thead tr").empty(),jQuery("#ponchoTable thead tr").append(o),jQuery.each(c,function(o,e){var i,n;1<o&&(n=i="",jQuery.each(d,function(e,t){var s,a="",r=c[o][e];d[e].includes("btn-")&&r&&(r='<a aria-label="'+(s=c[0][e].replace("btn-","").replace("-"," "))+'" class="btn btn-primary btn-sm margin-btn" target="_blank" href="'+r+'">'+s+"</a>"),d[e].includes("filtro-")&&r&&(l=e,s=c[1][e],jQuery("#tituloFiltro").html(s),h.push(r)),d[e].includes("fecha-")&&r&&(s=r.split("/"),r='<span style="display:none;">'+new Date(s[2],s[1]-1,s[0]).toISOString().split("T")[0]+"</span>"+r),r||(r="",a="hidden-xs"),i+=r,r=(new showdown.Converter).makeHtml(r),n+='<td class="'+a+'" data-title="'+p[e]+'">'+r+"</td>"}),""!=i&&(u=(u+="<tr>")+n+"</tr>"))}),jQuery.each(h.filter(function(e,t,s){return t===s.indexOf(e)}),function(e,t){jQuery("#ponchoTableFiltro").append("<option>"+t+"</option>")}),jQuery("#ponchoTable tbody").empty(),jQuery("#ponchoTableSearchCont").show(),jQuery("#ponchoTable tbody").append(u),jQuery("#ponchoTable").removeClass("state-loading");var e=jQuery.fn.DataTable.ext.type.search,s=(e.string=function(e){return e?"string"==typeof e?t(e):e:""},e.html=function(e){return e?"string"==typeof e?t(e.replace(/<.*?>/g,"")):e:""},jQuery.isFunction(jQuery.fn.DataTable.ext.order.intl)&&(jQuery.fn.DataTable.ext.order.intl("es"),jQuery.fn.DataTable.ext.order.htmlIntl("es")),jQuery("#ponchoTable").DataTable({lengthChange:!1,autoWidth:!1,pageLength:a.cantidadItems,columnDefs:[{type:"html-num",targets:a.tipoNumero},{targets:a.ocultarColumnas,visible:!1}],ordering:a.orden,order:[[a.ordenColumna-1,a.ordenTipo]],dom:"<'row'<'col-sm-6'l><'col-sm-6'f>><'row'<'col-sm-12'i>><'row'<'col-sm-12'tr>><'row'<'col-md-offset-3 col-md-6 col-sm-offset-2 col-sm-8'p>>",language:{sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ningún dato disponible en esta tabla",sInfo:"_TOTAL_ resultados",sInfoEmpty:"No hay resultados",sInfoFiltered:"",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:".",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"<<",sLast:">>",sNext:">",sPrevious:"<"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente",paginate:{first:"Ir a la primera página",previous:"Ir a la página anterior",next:"Ir a la página siguiente",last:"Ir a la última página"}}}}));jQuery(document).ready(function(){jQuery("#ponchoTableSearch").keyup(function(){s.search(jQuery.fn.DataTable.ext.type.search.string(this.value)).draw()})}),jQuery("#ponchoTable_filter").parent().parent().remove(),1<jQuery("#ponchoTableFiltro option").length&&jQuery("#ponchoTableFiltroCont").show(),jQuery("#ponchoTableFiltro").on("change",function(){var e=jQuery.fn.DataTable.ext.type.search.string(jQuery(this).val());""!=e?s.column(l).every(function(){this.search(e?"^"+e+"$":"",!0,!1).draw()}):s.search("").columns().search("").draw()})})}jQuery.fn.DataTable.isDataTable("#ponchoTable")&&jQuery("#ponchoTable").DataTable().destroy(),a.jsonUrl?s(a.jsonUrl):(t=a.hojaNumero,jQuery.getJSON("https://sheets.googleapis.com/v4/spreadsheets/"+a.idSpread+"/?alt=json&key=AIzaSyCq2wEEKL9-6RmX-TkW23qJsrmnFHFf5tY",function(e){e=e.sheets[t-1].properties.title;s("https://sheets.googleapis.com/v4/spreadsheets/"+a.idSpread+"/values/"+e+"?alt=json&key=AIzaSyCq2wEEKL9-6RmX-TkW23qJsrmnFHFf5tY")}))}jQuery("#ponchoTable").addClass("state-loading");var content_popover=document.getElementById("content-popover");function popshow(){content_popover.classList.toggle("hidden")}function pophidde(){content_popover.classList.add("hidden")}var ponchoUbicacion=function(e){var s,a,r,o,t="/profiles/argentinagobar/themes/contrib/poncho/resources/jsons/geoprovincias.json",i="/profiles/argentinagobar/themes/contrib/poncho/resources/jsons/geolocalidades.json",n=jQuery('input[name="submitted['+e.provincia+']"]'),l=jQuery('input[name="submitted['+e.localidad+']"]');function c(e){return e.charAt(0).toUpperCase()+e.slice(1)}function d(e,t,s,a=!1,r=!1,o=!1){var i=jQuery("<select></select>").attr("id",t).attr("name",e).addClass("form-control form-select").prop("required",a);return r&&i.append("<option value=''>Seleccione una opción</option>"),jQuery.each(s,function(e,t){let s="";o==t.nombre&&(s='selected="selected"'),i.append("<option value='"+t.id+"' "+s+">"+t.nombre+"</option>")}),i}function h(e,t){var s=l.prop("required");return n.val()?d("sLocalidades","sLocalidades",e.filter(function(e){return String(e.provincia.id)==String(t)}).map(function(e){return e.departamento.nombre&&(e.nombre=c(e.departamento.nombre.toLowerCase())+" - "+c(e.nombre.toLowerCase())),e}).sort(function(e,t){e=e.nombre.toUpperCase(),t=t.nombre.toUpperCase();return e.localeCompare(t)}),s,emptyOption=!!l.val(),l.val()):d("sLocalidades","sLocalidades",[],s,!0,!1)}t=e.urlProvincias||t,i=e.urlLocalidades||i,jQuery.getJSON(t,function(e){var t;s=[],e.results.forEach(function(e,t){s.push(e)}),e=[],e=(t=s).sort(function(e,t){e=e.nombre.toUpperCase(),t=t.nombre.toUpperCase();return e.localeCompare(t)}),t=n.prop("required"),(r=d("sProvincias","sProvincias",e,t,!0,n.val())).on("change",function(e){var t;n.val(""),l.val(""),o.children("option:not(:first)").remove(),""!=r.val()&&(n.val(r.find(":selected").text()),t=h(a,r.val()).find("option"),o.append(t),o.val(""))}),n.after(r),jQuery(r).select2()}),jQuery.getJSON(i,function(e){a=[],e.results.forEach(function(e,t){a.push(e)}),(o=h(a,r.val())).on("change",function(e){l.val(""),""!=o.val()&&l.val(o.find(":selected").text())}),l.after(o),jQuery(o).select2()}),n.hide(),l.hide()};function ponchoChart(t){"use strict";var e;function _e(e){return"HeatMap"==e?"heatmap":"Mixed"==e?"mixed":"Stacked Bar"==e?"bar":"Horizontal Bar"==e?"horizontalBar":"Area"==e?"line":"Pie"==e?"pie":"Bar"==e?"bar":"Line"==e?"line":""}function be(e){var t="";switch(e){case"celeste":case"info":t="#2897d4";break;case"verde":case"success":t="#2e7d33";break;case"rojo":case"danger":t="#c62828";break;case"amarillo":case"warning":t="#f9a822";break;case"azul":case"primary":t="#0072bb";break;case"negro":case"black":t="#333";break;case"uva":t="#6a1b99";break;case"gris":case"muted":t="#525252";break;case"grisintermedio":case"gris-area":case"gray":t="#f2f2f2";break;case"celesteargentina":case"celeste-argentina":t="#37bbed";break;case"fucsia":t="#ec407a";break;case"arandano":t="#c2185b";break;case"cielo":t="#039be5";break;case"verdin":t="#6ea100";break;case"lima":t="#cddc39";break;case"maiz":case"maíz":t="#ffce00";break;case"tomate":t="#ef5350";break;case"naranjaoscuro":case"naranja":t="#EF6C00";break;case"verdeazulado":case"verde-azulado":t="#008388";break;case"escarapela":t="#2cb9ee";break;case"lavanda":t="#9284be";break;case"mandarina":t="#f79525";break;case"palta":t="#50b7b2";break;case"cereza":t="#ed3d8f";break;case"limon":t="#d7df23";break;case"verdejade":case"verde-jade":t="#066";break;case"verdealoe":case"verde-aloe":t="#4fbb73";break;case"verdecemento":case"verde-cemento":t="#b4beba";break;default:console.log("No existe color "+e)}return t}function ye(e){var e=e.toString().replace(".",","),t=e.split(","),s=new Intl.NumberFormat("es-AR",{maximumFractionDigits:2}).format(t[0]);return e=1<t.length?s.concat(",",t[1].substr(0,2)):s}function s(e,a){var Q,F,t,P,s,r,G,z,D,o,i,B,N,n,l,R,$,U,c,d,V,h,Z,p,Y,u,m=[],f=[],g=[],W=[],_=[],b=[],y=[],v=[],x=0,k="",J=[],C=0,j=[],K=[],X=0,S=a.posicionLeyendas||"top",w="",w=void 0===a.mostrarLeyendas||a.mostrarLeyendas,E="",E=void 0===a.mostrarTotalStacked||a.mostrarTotalStacked,T=_e(a.tipoGrafico),L=e.values;if(jQuery.each(Object.keys(L[0]),function(e,t){var s;"eje-y"==L[0][e].substr(0,5)?(s=(s=L[0][e].split("-"))[0]+s[1],f.push(s),g.push(e)):"nombre-corto"==L[0][e]&&"heatmap"==T&&(X=e)}),jQuery.each(L,function(r,e){var a;0==r&&jQuery.each(g,function(e,t){var s=L[r][g[e]].split("-"),a=s[0]+s[1];y[a]=[],W.push(s[2]),"mixed"==T&&(3<s.length&&("barra"==s[3]||"linea"==s[3])?J.push(s[3]):(0==e&&J.push("barra"),1==e&&J.push("linea")))}),1==r&&jQuery.each(g,function(e,t){"pie"==T||"heatmap"==T?m.push(L[r][g[e]]):(b.push(L[r][g[e]]),x+=1)}),1<r&&(a=!1,jQuery.each(g,function(e,t){var s=L[0][g[e]].split("-"),s=s[0]+s[1];"pie"==T?y[s].push(L[r][g[e]]):"heatmap"==T?(0==a&&(b.push(L[r][0]),a=!0,x+=1),e!=X&&y[s].push(L[r][g[e]]),e+2==X&&(void 0===L[r][e+2]?K.push("*"):K.push(L[r][e+2]))):(0==a&&(m.push(L[r][0]),a=!0),y[s].push(L[r][g[e]]))}))}),"pie"==T?(Q=[],jQuery.each(Object.keys(f),function(e,t){e=f[e];y.hasOwnProperty(e)&&Q.push(y[e])}),v=Q):1==x&&jQuery.each(Object.keys(f),function(e,t){e=f[e];y.hasOwnProperty(e)&&(v=y[e])}),"mixed"!=T||0<(F=a.porcentajesMixed||"").length&&(j=F.split(",")),k=1==a.porcentajes?"line"==T&&1<x?{enabled:!0,callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s+"%"}},mode:"index",intersect:!1}:"pie"==T?{enabled:!0,callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.labels[e.index]+": "+s+"%"}}}:"Stacked Bar"==a.tipoGrafico?1==E?{enabled:!0,mode:"index",callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s+"%"},footer:(e,t)=>{e=e.reduce((e,t)=>e+parseFloat(t.yLabel),0);return"Total: "+new Intl.NumberFormat("es-AR",{maximumFractionDigits:2}).format(e)+"%"}}}:{enabled:!0,mode:"index",callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s+"%"}}}:{enabled:!0,mode:"index",callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s+"%"}}}:"line"==T&&1<x?{enabled:!0,callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s}},mode:"index",intersect:!1}:"pie"==T?{enabled:!0,callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.labels[e.index]+": "+s}}}:"Stacked Bar"==a.tipoGrafico&&1<x?1==E?{enabled:!0,mode:"index",intersect:!1,callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s},footer:(e,t)=>{e=e.reduce((e,t)=>e+parseFloat(t.yLabel),0);return"Total: "+new Intl.NumberFormat("es-AR",{maximumFractionDigits:2}).format(e)}}}:{enabled:!0,mode:"index",intersect:!1,callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s}}}:{enabled:!0,mode:"index",callbacks:{label:function(e,t){var s=ye(t.datasets[e.datasetIndex].data[e.index]);return t.datasets[e.datasetIndex].label+": "+s}}},"pie"==T&&(W.forEach(function(e,t,s){_.push(be(e))}),console.log("etiquetas --\x3e "+m),console.log("datos --\x3e "+v),console.log("colores --\x3e "+_),F=m,E=v,D=T,o=_,t=a.idComponenteGrafico,B=S,N=k,i=w,t=document.getElementById(t),new Chart(t,{type:D,data:{labels:F,datasets:[{data:E,borderColor:o,backgroundColor:o,borderWidth:2}]},options:{legend:{display:i,position:B},responsive:!0,tooltips:N}})),1==x&&(console.log("etiquetas --\x3e "+m),console.log("datos --\x3e "+v),t=be(W[0]),console.log("color --\x3e "+t),"Line"==a.tipoGrafico&&(D=m,E=v,o=T,i=t,B=b[0],N=a.ejeYenCero,n=a.idComponenteGrafico,l=S,R=k,$=w,n=document.getElementById(n),new Chart(n,{type:o,data:{labels:D,datasets:[{data:E,borderColor:i,backgroundColor:i,borderWidth:2,lineTension:0,fill:!1,label:B}]},options:{legend:{display:$,position:l},tooltips:R,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:N}}]}}})),"bar"!=T&&"Area"!=a.tipoGrafico||(n=m,E=v,$=T,l=t,R=b[0],P=a.ejeYenCero,s=a.idComponenteGrafico,r=S,G=k,z=w,s=document.getElementById(s),new Chart(s,{type:$,data:{labels:n,datasets:[{data:E,borderColor:l,backgroundColor:l,borderWidth:2,lineTension:0,label:R}]},options:{legend:{display:z,position:r},tooltips:G,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:P}}]}}})),"horizontalBar"==T&&(s=m,E=v,z=T,r=t,G=b[0],P=a.ejeYenCero,A=a.idComponenteGrafico,ie=S,ne=k,te=w,A=document.getElementById(A),new Chart(A,{type:z,data:{labels:s,datasets:[{data:E,borderColor:r,backgroundColor:r,borderWidth:2,lineTension:0,label:G}]},options:{legend:{display:te,position:ie},tooltips:ne,responsive:!0,scales:{xAxes:[{ticks:{beginAtZero:P}}]}}}))),1<x)if("heatmap"==T)if(void 0!==a.heatMapColors&&""!=a.heatMapColors&&void 0!==a.heatMapColorsRange&&""!=a.heatMapColorsRange){for(var ee=[],A="labelFila",E="labelColumna",te="labelValor",se=(void 0!==a.datosTooltip&&0<a.datosTooltip.length&&(void 0!==a.datosTooltip[0]&&void 0!==a.datosTooltip[0].labelFila&&(A=a.datosTooltip[0].labelFila),void 0!==a.datosTooltip[1]&&void 0!==a.datosTooltip[1].labelColumna&&(E=a.datosTooltip[1].labelColumna),void 0!==a.datosTooltip[2]&&void 0!==a.datosTooltip[2].labelValor&&(te=a.datosTooltip[2].labelValor)),jQuery.each(Object.keys(f),function(e,t){e=f[e];y.hasOwnProperty(e)&&(v=y[e],ee.push(v))}),[]),I=0;I<b.length;I++){for(var e=[],ae=0;ae<m.length;ae++){v={x:m[ae],y:parseInt(ee[ae][I])};e.push(v)}var re={name:("*"!=K[I]?K:b)[I],data:e};se.push(re)}for(var oe=[],I=0;I<a.heatMapColorsRange.length-1;I++){e={from:a.heatMapColorsRange[I],to:a.heatMapColorsRange[I+1],color:be(a.heatMapColors[I])};oe.push(e)}var ie="",ie=void 0===a.mostrarEjeY||a.mostrarEjeY;{var ne=se;var M=a.idComponenteGrafico;var le=b;var ce=oe;var de=A;var he=E;var pe=te;var E=a.tituloGrafico;var q=ie;var ue=S;var me=w;M=document.getElementById(M),new ApexCharts(M,{series:ne,chart:{height:650,type:"heatmap"},dataLabels:{enabled:!1},title:{text:E},tooltip:{custom:function({series:e,seriesIndex:t,dataPointIndex:s,w:a}){e=ye(e[t][s]);return'<div class="arrow_box"><span>'+de+": "+le[t]+"<br>"+he+": "+a.globals.labels[s]+"<br>"+pe+": "+e+"</span></div>"}},plotOptions:{heatmap:{shadeIntensity:.5,radius:0,useFillColorAsStroke:!1,colorScale:{ranges:ce}}},yaxis:{show:q},legend:{show:me,position:ue},responsive:[{breakpoint:1e3,options:{yaxis:{show:!1},legend:{show:me,position:"top"}}}]}).render();const ge=document.getElementsByClassName("apexcharts-toolbar");for(let e=0;e<ge.length;e++)ge[e].style.display="none"}}else void 0!==a.heatMapColors&&""!=a.heatMapColors||console.log("Completar vector con valores para los colores"),void 0!==a.heatMapColorsRange&&""!=a.heatMapColorsRange||console.log("Completar vector con el rango de valores para los colores");else{var O=[],H=0,fe=(W.forEach(function(e,t,s){_.push(be(e))}),console.log("colores --\x3e "+_),0);jQuery.each(Object.keys(f),function(e,t){var s,e=f[e];y.hasOwnProperty(e)&&(v=y[e],console.log("datos --\x3e "+v),"Line"==a.tipoGrafico?s={label:b[H],data:v,borderColor:_[H],fill:!1,borderWidth:2,lineTension:0,backgroundColor:_[H]}:"Bar"==a.tipoGrafico||"Area"==a.tipoGrafico||"Horizontal Bar"==a.tipoGrafico||"Stacked Bar"==a.tipoGrafico?s={label:b[H],data:v,borderColor:_[H],backgroundColor:_[H],borderWidth:2,lineTension:0}:"Mixed"==a.tipoGrafico&&("barra"==(e=J[fe])?s={label:b[H],data:v,backgroundColor:_[H],yAxisID:"left-y-axis",type:"bar"}:"linea"==e&&(s={label:b[H],data:v,borderColor:_[H],backgroundColor:_[H],type:"line",yAxisID:"right-y-axis",fill:!1})),O.push(s),H+=1,fe+=1)}),"mixed"==T&&(2==j.length?C=2:1==j.length?"eje-y1"==j[0]?C=0:"eje-y2"==j[0]&&(C=1):C=3),console.log("etiquetas --\x3e "+m),console.log("toltip --\x3e"+JSON.stringify(k)),"Stacked Bar"==a.tipoGrafico?(M=m,E=T,ce=O,q=a.idComponenteGrafico,ue=a.ejeYenCero,me=S,j=k,Y=w,q=document.getElementById(q),new Chart(q,{type:E,data:{labels:M,datasets:ce},options:{legend:{display:Y,position:me,labels:{textAlign:"center"}},tooltips:j,responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:ue},stacked:!0}],xAxes:[{stacked:!0}]}}})):"Mixed"==a.tipoGrafico?(E=m,Y="bar",j=O,c=a.idComponenteGrafico,d=a.ejeYenCero,V=S,h=C,C=b[0],Z=b[1],p=w,c=document.getElementById(c),new Chart(c,{type:Y,data:{labels:E,datasets:j},options:{legend:{display:p,position:V,labels:{textAlign:"center"}},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(e,t){var s="",a=((2==h||e.datasetIndex==h)&&(s="%"),ye(e.yLabel));return t.datasets[e.datasetIndex].label+": "+a+" "+s}}},responsive:!0,scales:{yAxes:[{id:"left-y-axis",type:"linear",position:"left",ticks:{beginAtZero:d,callback:function(e){return e+(1!=h&&2!=h?"":"%")}},scaleLabel:{display:!0,labelString:Z,fontColor:"black"}},{id:"right-y-axis",type:"linear",position:"right",ticks:{beginAtZero:d,callback:function(e){return e+(0!=h&&2!=h?"":"%")}},scaleLabel:{display:!0,labelString:C,fontColor:"black"}}]}}})):"Horizontal Bar"==a.tipoGrafico?(c=m,E=T,j=O,p=a.idComponenteGrafico,V=a.ejeYenCero,Z=S,d=k,C=w,p=document.getElementById(p),new Chart(p,{type:E,data:{labels:c,datasets:j},options:{legend:{display:C,position:Z,labels:{textAlign:"center"}},tooltips:d,responsive:!0,maintainAspectRatio:!0,scales:{xAxes:[{ticks:{beginAtZero:V}}]}}})):(E=m,j=T,C=O,u=a.idComponenteGrafico,U=a.ejeYenCero,S=S,k=k,w=w,u=document.getElementById(u),new Chart(u,{type:j,data:{labels:E,datasets:C},options:{legend:{display:w,position:S,labels:{textAlign:"center"}},tooltips:k,responsive:!0,maintainAspectRatio:!0,scales:{yAxes:[{ticks:{beginAtZero:U}}]}}}))}""!=a.tituloGrafico&&void 0!==a.tituloGrafico&&(u=a.idTagTituloGrafico,j=a.tituloGrafico,document.getElementById(u)&&(document.getElementById(u).innerHTML=j))}!function(e){var t=!1;(e.idSpread&&e.hojaNombre||e.jsonUrl||e.jsonInput)&&void 0!==e.tipoGrafico&&""!=e.tipoGrafico&&void 0!==e.idComponenteGrafico&&""!=e.idComponenteGrafico&&""!=_e(e.tipoGrafico)&&(t=!0);return t}(t)?(void 0!==t.idSpread&&""!=t.idSpread||console.log("Completar valor para la opción de Configuración idSpread"),void 0!==t.hojaNombre&&""!=t.hojaNombre||console.log("Completar valor para la opción de Configuración hojaNombre"),void 0!==t.tipoGrafico&&""!=t.tipoGrafico||console.log("Completar valor para la opción de Configuración tipoGrafico"),void 0!==t.idComponenteGrafico&&""!=t.idComponenteGrafico||console.log("Completar valor para la opción de Configuración idComponenteGrafico"),""==_e(t.tipoGrafico)&&console.log("Ingrese un tipo de gafico válido")):t.jsonInput?(console.log(t.jsonInput),s(jQuery.parseJSON(t.jsonInput),t)):(e=t.jsonUrl||"https://sheets.googleapis.com/v4/spreadsheets/"+t.idSpread+"/values/"+t.hojaNombre+"?alt=json&key=AIzaSyCq2wEEKL9-6RmX-TkW23qJsrmnFHFf5tY",jQuery.getJSON(e,function(e){s(e,t)}))}const gapi_legacy=e=>{const r=e.values[0],o=/ |\/|_/gi;let i=[];return e.values.forEach((t,e)=>{if(0<e){let e={};for(const a in r){var s=t.hasOwnProperty(a)?t[a].trim():"";e["gsx$"+r[a].toLowerCase().replace(o,"")]={$t:s}}i.push(e)}}),{feed:{entry:i}}};class PonchoMap{constructor(e,t){t=Object.assign({},{title:!1,id:"id",template:!1,template_structure:{},template_container_class_list:["info-container"],template_title_class_list:["h4","text-primary","m-t-0"],template_dl_class_list:["definition-list"],template_innerhtml:!1,template_markdown:!1,template_header:!1,template_dl:"dl",template_dt:"dt",template_dd:"dd",markdown_options:{extensions:["images","alerts","button","target","video"]},scope:"",slider:!1,scroll:!1,hash:!1,headers:{},map_selector:"map",anchor_delay:0,slider_selector:".slider",map_view:[-40.44,-63.59],map_anchor_zoom:16,map_zoom:4,reset_zoom:!0,latitud:"latitud",longitud:"longitud",marker:"azul",marker_cluster_options:{spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,maxClusterRadius:45,spiderfyDistanceMultiplier:.1,spiderLegPolylineOptions:{weight:1,color:"#666",opacity:.5}}},t);this.scope=t.scope,this.template=t.template,this.template_structure=t.template_structure,this.template_title_class_list=t.template_title_class_list,this.template_dl_class_list=t.template_dl_class_list,this.template_container_class_list=t.template_container_class_list,this.template_innerhtml=t.template_innerhtml,this.template_markdown=t.template_markdown,this.markdown_options=t.markdown_options,this.template_header=t.template_header,this.template_dl=t.template_dl,this.template_dt=t.template_dt,this.template_dd=t.template_dd,this.map_selector=t.map_selector,this.headers=t.headers,this.hash=t.hash,this.scroll=t.scroll,this.map_view=t.map_view,this.anchor_delay=t.anchor_delay,this.map_zoom=t.map_zoom,this.map_anchor_zoom=t.map_anchor_zoom,this.marker_cluster_options=t.marker_cluster_options,this.marker_color=t.marker,this.id=t.id,this.title=t.title,this.latitud=t.latitud,this.longitud=t.longitud,this.slider=t.slider,this.reset_zoom=t.reset_zoom,this.slider_selector=this.selectorName(t.slider_selector),this.selected_marker,this.scope_selector=`[data-scope="${this.scope}"]`,this.scope_sufix="--"+this.scope,this.data=this.setIdIfNotExists(e),this.map=new L.map(this.map_selector,{preferCanvas:!1}).setView(this.map_view,this.map_zoom),new L.tileLayer("https://gis.argentina.gob.ar/osm/{z}/{x}/{y}.png",{attribution:'&copy; Contribuidores <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this.map),this.markers=new L.markerClusterGroup(this.marker_cluster_options)}get entries(){return this.data}slugify=e=>{const t="àáâäæãåāăąçćčđďèéêëēėęěğǵḧîïíīįìıİłḿñńǹňôöòóœøōõőṕŕřßśšşșťțûüùúūǘůűųẃẍÿýžźż·/_,:;";var s=new RegExp(t.split("").join("|"),"g");return e.toString().toLowerCase().replace(/\s+/g,"-").replace(s,e=>"aaaaaaaaaacccddeeeeeeeegghiiiiiiiilmnnnnoooooooooprrsssssttuuuuuuuuuwxyyzzz------".charAt(t.indexOf(e))).replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")};removeAccents=e=>e?e.replace(/έ/g,"ε").replace(/[ύϋΰ]/g,"υ").replace(/ό/g,"ο").replace(/ώ/g,"ω").replace(/ά/g,"α").replace(/[ίϊΐ]/g,"ι").replace(/ή/g,"η").replace(/\n/g," ").replace(/[áÁ]/g,"a").replace(/[éÉ]/g,"e").replace(/[íÍ]/g,"i").replace(/[óÓ]/g,"o").replace(/[Öö]/g,"o").replace(/[úÚ]/g,"u").replace(/ê/g,"e").replace(/î/g,"i").replace(/ô/g,"o").replace(/è/g,"e").replace(/ï/g,"i").replace(/ü/g,"u").replace(/ã/g,"a").replace(/õ/g,"o").replace(/ç/g,"c").replace(/ì/g,"i"):"";setIdIfNotExists=e=>{return e.filter((e,t)=>0===t).every(e=>e.hasOwnProperty("id"))?e:e.map((e,t)=>{return{id:t+1+(this.title?"-"+this.slugify(e[this.title]):""),...e}})};addHash=e=>{window.location.hash="#"+e};entry=t=>this.entries.find(e=>e[this.id]==t);searchEntry=(t,e)=>{return e=void 0===e?this.entries:e,t?e.filter(e=>{if(this.searchTerm(t,e))return e}):e};searchTerm=(e,t)=>{for(const a of["text",...this.search_fields].filter(e=>e))if(t.hasOwnProperty(a)){var s=this.removeAccents(e).toUpperCase();const r=this.removeAccents(t[a]).toString().toUpperCase();try{if(r.includes(s))return t}catch(e){console.error(e)}}return null};selectorName=e=>e.replace(/^(\.|\#)/,"");scrollCenter=()=>{const e=document.getElementById(this.map_selector);var t=e.getBoundingClientRect(),s=(e.offsetLeft+e.offsetWidth)/2,t=t.top+window.scrollY;window.scrollTo({top:t,left:s,behavior:"smooth"})};clearContent=()=>document.querySelector(".js-content"+this.scope_sufix).innerHTML="";toggleSlider=()=>{document.querySelector(".js-slider"+this.scope_sufix).classList.toggle(this.slider_selector+"--in");const e=document.querySelector(".js-slider"+this.scope_sufix);this.isSliderOpen()?e.style.display="block":e.style.display="none"};clickToggleSlider=()=>document.querySelectorAll(".js-close-slider"+this.scope_sufix).forEach(e=>e.addEventListener("click",()=>{this.clearContent(),this.toggleSlider()}));isSliderOpen=()=>document.querySelector(".js-slider"+this.scope_sufix).classList.contains(this.slider_selector+"--in");setContent=e=>{this.isSliderOpen()||this.toggleSlider();e="function"==typeof this.template?this.template(this,e):this.defaultTemplate(this,e);document.querySelector(".js-content"+this.scope_sufix).innerHTML=e,document.querySelector(".slider--in").addEventListener("animationend",function(e){document.querySelector("#js-anchor-slider"+this.scope_sufix).focus()})};header=e=>this.headers.hasOwnProperty(e)?this.headers[e]:e;validateLatLng=t=>{t=t.toString().split(",");{let e=0;if(e<t.length)return!(isNaN(t[e])||t[e]<-127||75<t[e])}};renderSlider=()=>{document.querySelectorAll(".js-slider"+this.scope_sufix).forEach(e=>e.remove());const e=document.createElement("button"),t=(e.classList.add("btn","btn-xs","btn-secondary","btn-close","js-close-slider"+this.scope_sufix),e.title="Cerrar panel",e.setAttribute("role","button"),e.setAttribute("aria-label","Cerrar panel de información"),e.innerHTML='<span class="sr-only">Cerrar</span>✕',document.createElement("a")),s=(t.href="#",t.setAttribute("tabindex","0"),t.id="js-anchor-slider"+this.scope_sufix,document.createElement("div")),a=(s.classList.add("content-container"),document.createElement("div")),r=(a.classList.add("content","js-content"+this.scope_sufix),s.appendChild(a),document.createElement("div"));r.style.display="none",r.setAttribute("role","region"),r.setAttribute("aria-live","polite"),r.classList.add("slider","js-slider"+this.scope_sufix),r.id="slider"+this.scope_sufix,r.appendChild(e),r.appendChild(t),r.appendChild(s),document.querySelector(this.scope_selector+".poncho-map").appendChild(r)};showSlider=(e,t)=>{this.map.setView([t[this.latitud],t[this.longitud]],this.map_anchor_zoom),e.fireEvent("click")};showPopup=e=>{this.markers.zoomToShowLayer(e,()=>{e.__parent.spiderfy(),e.openPopup()})};removeHash=()=>history.replaceState(null,null," ");hasHash=()=>{return window.location.hash.replace("#","")||!1};gotoHashedEntry=()=>{var e=this.hasHash();e&&this.gotoEntry(e)};gotoEntry=t=>{const s=this.entry(t);this.markers.eachLayer(e=>{e.options.id==t&&(this.setSelectedMarker(t,e),this.hash&&this.addHash(t),this.slider&&this.hash?this.showSlider(e,s):this.showPopup(e))})};clickeableMarkers=()=>{this.markers.eachLayer(t=>{t.on("keypress click",e=>{document.querySelectorAll(".marker--active").forEach(e=>e.classList.remove("marker--active"));try{e.sourceTarget._icon.classList.add("marker--active")}catch(e){}e=this.entries.find(e=>e[this.id]==t.options.id);this.setContent(e)})})};urlHash=()=>{this.markers.eachLayer(t=>{t.on("click",e=>{this.addHash(t.options.id)})})};removeListElement=(e,t)=>{t=e.indexOf(t);return-1<t&&e.splice(t,1),e};templateTitle=e=>{const t=this.template_structure;var s=!!t.hasOwnProperty("title")&&t.title,a=this.title||!1;if(t.hasOwnProperty("title")&&"boolean"==typeof t.title)return!1;if(!s&&!a)return!1;s=s||a;let r;if(this.template_header){const i=document.createElement("div");i.innerHTML=this.mdToHtml(this.template_header(this,e)),r=i}else(r=document.createElement("h1")).classList.add(...this.template_title_class_list),r.textContent=e[s];const o=document.createElement("header");return o.className="header",o.appendChild(r),o};templateList=e=>{const t=this.template_structure;var s=Object.keys(e);let a=s;if(t.hasOwnProperty("values")&&0<t.values.length)a=t.values;else if(t.hasOwnProperty("exclude")&&0<t.exclude.length)for(const r of t.exclude)a=this.removeListElement(s,r);return a};mdToHtml=e=>{if(this.template_markdown&&this.markdownEnable()){const t=new showdown.Converter(this.markdown_options);return t.makeHtml(e)}return e};markdownEnable=()=>!("undefined"==typeof showdown||!showdown.hasOwnProperty("Converter"));templateMixing=o=>{if(this.template_structure.hasOwnProperty("mixing")&&0<this.template_structure.mixing.length){const e=this.template_structure.mixing;let r={};return e.forEach(e=>{const{values:t,separator:s=", ",key:a}=e;if(void 0===a)throw"Mixing requiere un valor en la variable «key».";r[a]=t.map(e=>o[e]).filter(e=>e).join(s)}),Object.assign({},o,r)}return o};defaultTemplate=(e,t)=>{var s=this.templateList(t),a=this.templateTitle(t);const r=document.createElement("article"),o=(r.classList.add(...this.template_container_class_list),document.createElement(this.template_dl));o.classList.add(...this.template_dl_class_list),o.style.fontSize="1rem",t=this.templateMixing(t);for(const i of s)if(!t.hasOwnProperty(i)||t[i]){const n=document.createElement(this.template_dt),l=(n.classList.add("h6","m-b-0"),n.textContent=this.header(i),document.createElement(this.template_dd));l.textContent=t[i],this.template_markdown?l.innerHTML=this.mdToHtml(t[i]):this.template_innerhtml&&(l.innerHTML=t[i]),""!=this.header(i)&&o.appendChild(n),o.appendChild(l)}return a&&r.appendChild(a),r.appendChild(o),r.outerHTML};icon=(e="azul")=>new L.icon({iconUrl:`https://www.argentina.gob.ar/sites/default/files/marcador-${e}.svg`,iconSize:[27,38],iconAnchor:[13,38],popupAnchor:[0,-37]});resetView=()=>this.map.setView(this.map_view,this.map_zoom);fitBounds=()=>{try{this.map.fitBounds(this.markers.getBounds())}catch(e){console.error(e)}};resetViewButton=()=>{this.reset_zoom&&(document.querySelectorAll(".js-reset-view"+this.scope_sufix).forEach(e=>e.remove()),document.querySelectorAll(this.scope_selector+" .leaflet-control-zoom-in").forEach(e=>{const t=document.createElement("i"),s=(t.classList.add("fa","fa-expand"),t.setAttribute("aria-hidden","true"),document.createElement("a"));s.classList.add("js-reset-view"+this.scope_sufix,"leaflet-control-zoom-reset"),s.href="#",s.title="Zoom para ver todo el mapa",s.setAttribute("role","button"),s.setAttribute("aria-label","Zoom para ver todo el mapa"),s.appendChild(t),s.onclick=e=>{e.preventDefault(),this.resetView()},e.after(s)}))};marker=e=>{var t;return this.marker_color&&"boolean"!=typeof this.marker_color?"string"==typeof this.marker_color?this.icon(this.marker_color):"string"==typeof this.marker_color(this,e)?(t=this.marker_color(this,e),this.icon(t)):"function"==typeof this.marker_color?this.marker_color(this,e):void 0:null};markersMap=e=>{this.markers.clearLayers(),e.forEach(t=>{var s=this.marker(t),a=t[this.id],r=t[this.latitud],o=t[this.longitud];if(this.validateLatLng(r)&&this.validateLatLng(o)){let e={};a&&(e.id=a),s&&(e.icon=s),e.title=this.title?t[this.title]:"",e.alt=this.title?"Ubicación en el mapa de "+t[this.title]:"";const i=new L.marker([r,o],e);this.markers.addLayer(i),this.slider||(a="function"==typeof this.template?this.template(this,t):this.defaultTemplate(this,t),i.bindPopup(a))}}),this.map.options.minZoom=2,this.map.addLayer(this.markers)};setSelectedMarker=(e,t)=>{e={entry:this.entry(e),marker:t};return this.selected_marker=e};selectedMarker=()=>{this.markers.eachLayer(t=>{t.on("click",e=>{this.setSelectedMarker(t.options.id,t)})})};hiddenSearchInput=()=>{const t=document.createElement("input"),e=(t.type="hidden",t.name="js-search-input"+this.scope_sufix,t.setAttribute("disabled","disabled"),t.id="js-search-input"+this.scope_sufix,document.querySelectorAll(this.scope_selector+".poncho-map"));e.forEach(e=>e.appendChild(t))};accesibleMenu=()=>{const e=[[this.scope_selector+" .leaflet-marker-pane","leaflet-marker-pane"+this.scope_sufix],[this.scope_selector+" .leaflet-control-zoom","leaflet-control-zoom"+this.scope_sufix]],t=(e.forEach(e=>document.querySelector(e[0]).id=e[1]),[{text:"Ir a los marcadores del mapa",anchor:"#"+e[0][1]},{text:"Ir al panel de zoom",anchor:"#"+e[1][1]}]),a=(void 0!==this.filters&&t.push({text:"Ir al panel de filtros",anchor:"#filtrar-busqueda"+this.scope_sufix}),document.createElement("ul"));a.className="sr-only",t.forEach(e=>{const t=document.createElement("a"),s=(t.textContent=e.text,t.href=e.anchor,document.createElement("li"));s.appendChild(t),a.appendChild(s)}),document.querySelectorAll(""+this.scope_selector).forEach(e=>{e.insertBefore(a,e.children[0])})};render=()=>{console.log("%cPonchoMap","padding:5px;border-radius:6px;background: #0072bb;color: #fff"),this.hiddenSearchInput(),this.resetViewButton(),this.markersMap(this.entries),this.selectedMarker(),this.slider&&(this.renderSlider(),this.clickeableMarkers(),this.toggleSlider(),this.clickToggleSlider()),this.hash&&this.urlHash(),this.scroll&&this.hasHash()&&this.scrollCenter(),this.accesibleMenu(),setTimeout(this.gotoHashedEntry,this.anchor_delay)}}class PonchoMapFilter extends PonchoMap{constructor(e,t){super(e,t);e=Object.assign({},{filters:[],filters_visible:!1,search_fields:[],messages:{reset:'<a href="#" class="{{reset_search}}">Reestablecer</a>',initial:"Hay {{total_results}} puntos en el mapa.",no_results_by_term:'No encontramos resultados para tu búsqueda. <a href="#" class="{{reset_search}}">Reestablecer</a>',no_results:'No se encontraron entradas. <a href="#" class="{{reset_search}}">Reestablecer</a>',results:'{{total_results}} resultados coinciden con tu búsqueda. <a href="#" class="{{reset_search}}">Reestablecer</a>',one_result:'{{total_results}} resultado coincide con tu búsqueda. <a href="#" class="{{reset_search}}">Reestablecer</a>',has_filters:'<i title="¡Advertencia!" aria-hidden="true" class="fa fa-warning text-mandarina"></i> Se están usando <a href="{{anchor}}" title="Abre o cierra el panel de filtros"class="{{filter_class}}">filtros</a>.'}},t);this.filters=e.filters,this.filters_visible=e.filters_visible,this.valid_fields=["checkbox","radio"],this.search_fields=e.search_fields,this.messages=e.messages}tplParser=(e,a)=>Object.keys(a).reduce((e,t)=>{var s=new RegExp("\\{\\{\\s{0,2}"+t+"\\s{0,2}\\}\\}","gm");return e=e.replace(s,a[t])},e);helpText=r=>{const e=document.querySelectorAll(this.scope_selector+" .js-poncho-map__help");e.forEach(e=>{e.innerHTML="";var t={total_results:r.length,total_entries:this.entries.length,total_filtered_entries:this.filtered_entries.length,filter_class:"js-close-filter"+this.scope_sufix,anchor:"#",term:this.inputSearchValue,reset_search:"js-poncho-map-reset"+this.scope_sufix};const s=document.createElement("ul");s.classList.add("m-b-0","list-unstyled"),s.setAttribute("role","region"),s.setAttribute("aria-live","polite");var a=e=>{const t=document.createElement("li");return t.innerHTML=e,t};t.total_entries===t.total_results?s.appendChild(a(this.tplParser(this.messages.initial,t))):t.total_results<1?s.appendChild(a(this.tplParser(this.messages.no_results_by_term,t))):""===this.inputSearchValue&&t.total_results<1?s.appendChild(a(this.tplParser(this.messages.no_results,t))):1==t.total_results?s.appendChild(a(this.tplParser(this.messages.one_result,t))):1<t.total_results&&s.appendChild(a(this.tplParser(this.messages.results,t))),this.usingFilters()||s.appendChild(a(this.tplParser(this.messages.has_filters,t))),e.appendChild(s)})};filterPosition=e=>{e=/(?:__([0-9]+))(?:__([0-9]+))?$/gm.exec(e);return e?parseInt(e[1]):null};isFilterOpen=()=>document.querySelector(".js-poncho-map-filters"+this.scope_sufix).classList.contains("filter--in");toggleFilter=()=>{document.querySelector(".js-poncho-map-filters"+this.scope_sufix).classList.toggle("filter--in")};filterContainerHeight=()=>{var e=document.querySelector(".js-filter-container"+this.scope_sufix),t=document.querySelector(".js-close-filter"+this.scope_sufix),e=e.offsetParent.offsetHeight-e.offsetTop-t.offsetHeight-20;const s=document.querySelector(".js-poncho-map-filters"+this.scope_sufix);s.style.maxHeight=e+"px";t=s.offsetHeight-45;const a=document.querySelector(".js-filters"+this.scope_sufix);a.style.height=t+"px",a.style.overflow="auto"};clickToggleFilter=()=>document.querySelectorAll(".js-close-filter"+this.scope_sufix).forEach(e=>e.onclick=e=>{e.preventDefault(),this.toggleFilter(),this.filterContainerHeight()});fields=(e,t)=>{const s=document.createElement("div");s.classList.add("field-list","p-b-1");for(const o in e.fields){var a=e.fields[o];const i=document.createElement("input"),n=(i.type=this.valid_fields.includes(e.type)?e.type:"checkbox",i.id=`id__${a[0]}__${t}__`+o,"radio"==e.type?i.name=a[0]+"__"+t:i.name=a[0]+`__${t}__`+o,i.className="form-check-input",i.value=o,void 0!==a[3]&&"checked"==a[3]&&i.setAttribute("checked","checked"),document.createElement("label")),l=(n.style.marginLeft=".33rem",n.textContent=a[1],n.className="form-check-label",n.setAttribute("for",`id__${a[0]}__${t}__`+o),document.createElement("div"));l.className="form-check",l.appendChild(i),l.appendChild(n),s.appendChild(l)}const r=document.createElement("div");return r.appendChild(s),r};filterButton=()=>{const e=document.createElement("i"),t=(e.setAttribute("aria-hidden","true"),e.classList.add("fa","fa-filter"),document.createElement("span")),s=(t.textContent="Abre o cierra el filtro de búsqueda",t.classList.add("sr-only"),document.createElement("button")),a=(s.classList.add("btn","btn-secondary","btn-filter","js-close-filter"+this.scope_sufix),s.id="filtrar-busqueda"+this.scope_sufix,s.appendChild(e),s.appendChild(t),s.setAttribute("role","button"),s.setAttribute("aria-label","Abre o cierra el filtro de búsqueda"),s.setAttribute("aria-controls","poncho-map-filters"+this.scope_sufix),document.createElement("div")),r=(a.classList.add("js-filter-container"+this.scope_sufix,"filter-container"),this.reset_zoom&&a.classList.add("filter-container--zoom-expand"),a.appendChild(s),document.querySelector(".poncho-map"+this.scope_selector));r.appendChild(a)};filterContainer=()=>{const e=document.createElement("div"),t=(e.className="js-filters"+this.scope_sufix,document.createElement("button")),s=(t.classList.add("btn","btn-xs","btn-secondary","btn-close","js-close-filter"+this.scope_sufix),t.title="Cerrar panel",t.setAttribute("role","button"),t.setAttribute("aria-label","Cerrar panel de filtros"),t.innerHTML='<span class="sr-only">Cerrar </span>✕',document.createElement("form")),a=(s.classList.add("js-formulario"+this.scope_sufix),s.appendChild(t),s.appendChild(e),document.createElement("div"));a.classList.add("js-poncho-map-filters"+this.scope_sufix,"poncho-map-filters"),a.setAttribute("role","region"),a.setAttribute("aria-live","polite"),a.id="poncho-map-filters"+this.scope_sufix,this.filters_visible&&a.classList.add("filter--in"),a.appendChild(s),document.querySelectorAll(".js-filter-container"+this.scope_sufix).forEach(e=>e.appendChild(a))};createFilters=e=>{const r=document.querySelector(".js-filters"+this.scope_sufix);e.forEach((e,t)=>{let s=document.createElement("legend"),a=(s.textContent=e.legend,s.classList.add("m-b-1","text-primary","h6"),document.createElement("fieldset"));a.appendChild(s),a.appendChild(this.fields(e,t)),r.appendChild(a)})};formFilters=()=>{if(this.filters.length<1)return[];var e=document.querySelector(".js-formulario"+this.scope_sufix);const s=new FormData(e);return Array.from(s).map(e=>{let t=[];return"number"==typeof this.filterPosition(e[0])?t=[this.filterPosition(e[0]),parseInt(e[1])]:e[0]=="js-search-input"+this.scope_sufix&&(t=["input",s.get("js-search-input"+this.scope_sufix)]),t})};defaultFiltersConfiguration=()=>{return this.filters.map((e,s)=>e.fields.map((e,t)=>[s,t,e[0],"undefinded"!=typeof e[3]&&"checked"==e[3]])).flat()};usingFilters=()=>{return this.defaultFiltersConfiguration().every(e=>document.querySelector(`#id__${e[2]}__${e[0]}__`+e[1]).checked)};resetFormFilters=()=>{this.defaultFiltersConfiguration().forEach(e=>{const t=document.querySelector(`#id__${e[2]}__${e[0]}__`+e[1]);t.checked=e[3]})};get inputSearchValue(){const e=document.querySelector("#js-search-input"+this.scope_sufix);var t=e.value.trim();return""!==t&&t}countOccurrences=(e,s,a)=>e.reduce((e,t)=>s.some(e=>t[a].includes(e))?e+1:e,0);totals=()=>{return this.formFilters().filter(e=>"input"!=e[0]).map(e=>{var t=this.filters[e[0]].fields[e[1]];return[t[1],this.countOccurrences(this.filtered_entries,t[2],t[0]),...e]})};_validateEntry=(t,s)=>{var a=this.filters.length;let r=[];for(let e=0;e<a;e++)r.push(this._validateGroup(t,(t=>s.filter(e=>e[0]==t))(e)));return r.every(e=>e)};_search=(t,e,s)=>{const a=this.filters[e].fields[s],r=a[2];return r.some(e=>t[a[0]].includes(e))};_validateGroup=(t,e)=>{const s=e.map(e=>this._search(t,e[0],e[1]));return s.some(e=>e)};filterData=()=>{const t=this.formFilters();let e=this.entries.filter(e=>this._validateEntry(e,t));return e=this.searchEntry(this.inputSearchValue,e),e=this.filters.length<1||0<t.length?e:[],this.filtered_entries=e};filteredData=e=>{e=void 0!==e?this.entries:this.filterData(),this.markersMap(e),this.selectedMarker(),this.helpText(e),this.resetSearch(),this.clickToggleFilter(),this.slider&&(this.renderSlider(),this.clickeableMarkers(),this.clickToggleSlider()),this.hash&&this.urlHash()};clearSearchInput=()=>document.querySelectorAll("#js-search-input"+this.scope_sufix).forEach(e=>e.value="");resetSearch=()=>document.querySelectorAll(".js-poncho-map-reset"+this.scope_sufix).forEach(e=>{e.onclick=e=>{e.preventDefault(),this.resetFormFilters(),this.filteredData(this.entries),this.clearSearchInput()}});filterChange=t=>document.querySelectorAll(".js-filters"+this.scope_sufix).forEach(e=>{e.onchange=t});render=()=>{console.log("%cPonchoMapFilter","padding:5px;border-radius:6px;background: #aaff00;color: #000"),this.hiddenSearchInput(),this.resetViewButton(),0<this.filters.length&&(this.filterButton(),this.filterContainer(),this.createFilters(this.filters)),this.filteredData(),this.scroll&&this.hasHash()&&this.scrollCenter(),this.filterChange(e=>{e.preventDefault(),this.filteredData()}),setTimeout(this.gotoHashedEntry,this.anchor_delay),this.filters_visible&&this.filterContainerHeight(),this.accesibleMenu()}}class PonchoMapSearch{constructor(e,t){var s={scope:!1,template:!1,allow_clear:!1,placeholder:"Su búsqueda",theme:"poncho",minimum_input_length:0,search_fields:e.search_fields,sort:!0,sort_reverse:!1,sort_key:"text"},s=(this.instance=e,Object.assign({},s,t));this.theme=s.theme,this.template="function"==typeof s.template&&s.template,this.text=e.title||!1,this.placeholder=s.placeholder,this.allow_clear=s.allow_clear,this.scope=s.scope,this.sort_key=s.sort_key,this.minimum_input_length=s.minimum_input_length,this.sort=s.sort,this.sort_reverse=s.sort_reverse,this.search_scope_selector=this.scope?`[data-scope="${this.scope}"]`:"",this.instance.search_fields=s.search_fields}sortData=(e,a)=>{let t=e.sort((e,t)=>{var s=e=>this.instance.removeAccents(e).toUpperCase();return s(e[a])<s(t[a])?-1:s(e[a])>s(t[a])?1:0});return this.sort_reverse?t.reverse():t};matchTerm=(e,t)=>void 0===e.term||""===e.term.toString().trim()?t:this.instance.searchTerm(e.term,t);dataSelect=e=>e.map(e=>{let t={id:e[this.instance.id],text:e[this.text]};return t.html=this.template?this.template(this,e):e[this.text],{...e,...t,selected:!1}});dataset=()=>{var e=this.instance instanceof PonchoMapFilter?this.instance.filtered_entries:this.instance.entries;let t=this.dataSelect(this.sortData(e,this.sort_key));return t=this.sort?t:this.dataSelect(e)};selectTwo=()=>{jQuery.isFunction(jQuery.fn.select2)&&jQuery(this.search_scope_selector+" .js-poncho-map-search__select2").select2({data:this.dataset(),matcher:this.matchTerm,tags:!0,language:{inputTooShort:function(){return"Debe introducir al menos 2 caracteres…"}},allowClear:this.allow_clear,theme:this.theme,minimumInputLength:this.minimum_input_length,placeholder:this.placeholder,escapeMarkup:function(e){return e},templateResult:function(e){return e.html},templateSelection:function(e){return e.text}}).on("select2:select",e=>{this.instance.gotoEntry(e.params.data.id)}).on("select2:open",()=>{document.querySelectorAll(".select2-search__field").forEach(e=>e.focus())})};firstEmptyOption=()=>document.querySelectorAll(this.search_scope_selector+" .js-poncho-map-search__select2").forEach(e=>{e.innerHTML="",e.appendChild(document.createElement("option"))});triggerSearch=()=>{const s=document.querySelector(this.search_scope_selector+" .js-poncho-map-search__input"),e=document.querySelectorAll(this.search_scope_selector+" .js-poncho-map-search__submit");e.forEach(e=>{e.onclick=e=>{e.preventDefault();const t=document.querySelector("#js-search-input"+this.instance.scope_sufix);t.value=s.value;e=s.value;this.renderSearch(e)}})};keyup=()=>{const e=document.querySelectorAll(this.search_scope_selector+" .js-poncho-map-search__input");e.forEach(e=>{const t=document.querySelector("#js-search-input"+this.instance.scope_sufix);e.onkeyup=()=>{t.value=e.value},e.onkeydown=()=>{t.value=e.value}})};cleanInput=()=>document.querySelector(this.search_scope_selector+" .js-poncho-map-search__input").value="";placeHolder=()=>{if(!this.placeholder)return"";document.querySelectorAll(this.search_scope_selector+" .js-poncho-map-search__input").forEach(e=>e.placeholder=this.placeholder.toString())};cleanHelpText=()=>document.querySelector(this.instance.scope_selector+" .js-poncho-map__help").innerHTML="";renderSearch=e=>{var t=this.instance.filterData();this.instance.markersMap(t),this.instance.slider&&(this.instance.renderSlider(),this.instance.clickeableMarkers(),this.instance.clickToggleSlider()),this.instance.hash&&this.instance.urlHash(),this.instance.resetView(),1==t.length?this.instance.gotoEntry(t[0][this.instance.id]):""!=e.trim()&&(this.instance.removeHash(),setTimeout(this.instance.fitBounds,350)),this.instance.helpText(t),this.instance.resetSearch(),this.instance.clickToggleFilter()};addDataListOptions=()=>document.querySelectorAll(this.search_scope_selector+" #js-porcho-map-search__list").forEach(t=>{t.innerHTML=new Date;this.instance.filtered_entries.forEach(e=>t.appendChild((e=>{const t=document.createElement("option");return t.textContent=e,t})(e[this.text])))});render=()=>{console.log("%cPonchoMapFilterSearch","padding:5px;border-radius:6px;background: #ff4400;color: #fff"),this.firstEmptyOption(),this.selectTwo(),this.placeHolder(),this.triggerSearch(),this.addDataListOptions(),this.instance.filterChange(e=>{e.preventDefault(),this.instance.filteredData(),this.addDataListOptions()}),this.keyup()}}class GapiSheetData{constructor(e){e=Object.assign({},{gapi_key:"AIzaSyAll9EH1aTmZDewNSyM_CU_AIsGOiEDyZs"},e);this.gapi_key=e.gapi_key}url=(e,t)=>["https://sheets.googleapis.com/v4/spreadsheets/",t,"/values/",e,"?key=",this.gapi_key,"&alt=json"].join("");json_data=e=>{e=this.feed(e);return{feed:e,entries:this.entries(e),headers:this.headers(e)}};feed=e=>{const r=e.values[0],o=/ |\/|_/gi;let i=[];return e.values.forEach((t,e)=>{if(0<e){let e={};for(var s in r){var a=t.hasOwnProperty(s)?t[s].trim():"";e[""+r[s].toLowerCase().replace(o,"")]=a}i.push(e)}}),i};gapi_feed_row=(e,t="-",s=!0)=>{const a=s?"filtro-":"",r=Object.entries(e);let o={};return r.map(e=>o[(e=>e.replace("gsx$","").replace(a,"").replace(/-/g,t))(e[0])]=e[1].$t),o};entries=e=>e.filter((e,t)=>0<t);headers=e=>e.find((e,t)=>0==t)}async function fetch_json(e,t="GET"){const s=await fetch(e,{method:t,headers:{Accept:"application/json","Content-Type":"application/json"}});if(s.ok)return s.json();throw new Error("HTTP error! status: "+s.status)}